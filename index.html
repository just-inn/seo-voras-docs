<!DOCTYPE html>
<html lang="en" style="scroll-behavior: smooth;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEOvoras - Article Submission Automation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #2d2d2d;
            color: #ffffff;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Language Switcher */
        .lang-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 0;
            border-radius: 4px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .lang-btn {
            padding: 12px 20px;
            background: #363636;
            color: #999;
            border: none;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 1px;
            transition: all 0.2s ease;
        }

        .lang-btn:hover {
            background: #444;
            color: #fff;
        }

        .lang-btn.active {
            background: #8bc34a;
            color: #2d2d2d;
        }

        .lang-en, .lang-lt {
            display: none;
        }

        body.show-en .lang-en {
            display: block;
        }

        body.show-lt .lang-lt {
            display: block;
        }

        body.show-en .lang-en-inline,
        body.show-lt .lang-lt-inline {
            display: inline;
        }

        .lang-en-inline, .lang-lt-inline {
            display: none;
        }

        header {
            text-align: center;
            margin-bottom: 60px;
            padding: 60px 0;
        }

        h1 {
            font-size: 3.5rem;
            color: #ffffff;
            margin-bottom: 15px;
            font-weight: 300;
            letter-spacing: 8px;
            text-transform: uppercase;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #999999;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        section {
            background: #363636;
            border-radius: 4px;
            padding: 35px;
            margin-bottom: 25px;
        }

        section.standalone {
            border-left: 4px solid #8bc34a;
        }

        .section-divider {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 40px 0;
            color: #666;
            font-size: 0.8rem;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .section-divider::before,
        .section-divider::after {
            content: "";
            flex: 1;
            height: 1px;
            background: linear-gradient(to right, transparent, #555, transparent);
        }

        .executive-summary {
            background: #2a2a2a;
            border: 1px solid #444;
            border-left: 4px solid #8bc34a;
        }

        .executive-summary .lead {
            font-size: 1.1rem;
            color: #ffffff;
            margin-bottom: 25px;
            line-height: 1.7;
        }

        .executive-summary .decisions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .executive-summary .decision-item {
            display: none;
            align-items: flex-start;
            gap: 10px;
            color: #bbbbbb;
            font-size: 0.9rem;
        }

        body.show-en .executive-summary .decision-item.lang-en,
        body.show-lt .executive-summary .decision-item.lang-lt {
            display: flex;
        }

        .executive-summary .decision-item::before {
            content: "→";
            color: #8bc34a;
            flex-shrink: 0;
        }

        h2 {
            color: #ffffff;
            font-size: 1.3rem;
            margin-bottom: 20px;
            font-weight: 400;
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        h3 {
            color: #cccccc;
            font-size: 1rem;
            margin: 25px 0 12px 0;
            font-weight: 500;
        }

        p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #cccccc;
        }

        .flow-diagram {
            background: #2d2d2d;
            border-radius: 4px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.9;
            margin: 15px 0;
            overflow-x: auto;
            border-left: 3px solid #555;
        }

        .flow-diagram .arrow {
            color: #888;
        }

        .highlight {
            color: #8bc34a;
        }

        .warning {
            color: #ffa726;
        }

        ul {
            list-style: none;
            padding-left: 0;
        }

        ul li {
            padding: 8px 0 8px 25px;
            position: relative;
            color: #cccccc;
        }

        ul li::before {
            content: "—";
            position: absolute;
            left: 0;
            color: #666;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        th, td {
            padding: 14px 18px;
            text-align: left;
            border-bottom: 1px solid #444;
        }

        th {
            background: #2d2d2d;
            color: #ffffff;
            font-weight: 400;
            letter-spacing: 1px;
            text-transform: uppercase;
            font-size: 0.85rem;
        }

        td {
            color: #cccccc;
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        .status-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 2px;
            font-size: 0.8rem;
            font-weight: 500;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .status-ready {
            background: #8bc34a;
            color: #2d2d2d;
        }

        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .tech-item {
            background: #2d2d2d;
            padding: 20px 15px;
            border-radius: 4px;
            text-align: center;
        }

        .tech-item .icon {
            font-size: 1.8rem;
            margin-bottom: 12px;
            opacity: 0.9;
        }

        .tech-item div {
            color: #ffffff;
            font-size: 0.9rem;
        }

        .tech-item small {
            color: #888;
            font-size: 0.75rem;
        }

        .cost-total {
            font-size: 1.2rem;
            color: #8bc34a;
            text-align: center;
            padding: 18px;
            background: #2d2d2d;
            border-radius: 4px;
            margin-top: 15px;
            letter-spacing: 1px;
        }

        footer {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 0.85rem;
            letter-spacing: 1px;
        }

        .progress-example {
            background: #2d2d2d;
            padding: 15px 20px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
        }

        .progress-example span {
            margin-right: 25px;
            color: #cccccc;
        }

        .check {
            color: #8bc34a;
        }

        .key-decisions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .key-decision {
            background: #2d2d2d;
            padding: 18px;
            border-radius: 4px;
            border-left: 3px solid #8bc34a;
        }

        .key-decision strong {
            color: #ffffff;
            display: block;
            margin-bottom: 8px;
        }

        .key-decision p {
            margin: 0;
            font-size: 0.9rem;
        }

        .workflow-steps {
            display: flex;
            flex-wrap: wrap;
            gap: 0;
            margin: 20px 0 30px 0;
            justify-content: center;
            position: relative;
        }

        .workflow-step {
            background: #2d2d2d;
            padding: 12px 18px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: #cccccc;
            transition: all 0.2s ease;
            border-bottom: 3px solid transparent;
            position: relative;
        }

        .workflow-step:first-child {
            border-radius: 4px 0 0 4px;
        }

        .workflow-step:last-child {
            border-radius: 0 4px 4px 0;
        }

        .workflow-step:not(:last-child)::after {
            content: "";
            position: absolute;
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 6px solid #2d2d2d;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            z-index: 1;
        }

        .workflow-step:hover {
            background: #404040;
            border-bottom-color: #8bc34a;
        }

        .workflow-step .num {
            background: #8bc34a;
            color: #2d2d2d;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.75rem;
            flex-shrink: 0;
        }

        .step-section {
            scroll-margin-top: 20px;
        }

        .step-section h3 {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .step-section h3 .step-num {
            background: #8bc34a;
            color: #2d2d2d;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .ascii-diagram {
            background: #2d2d2d;
            border-radius: 4px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
            line-height: 1.4;
            margin: 20px 0;
            overflow-x: auto;
            white-space: pre;
            border-left: 3px solid #8bc34a;
        }

        @media (max-width: 600px) {
            .lang-switcher {
                top: 10px;
                right: 10px;
            }
            .lang-btn {
                padding: 10px 14px;
                font-size: 0.8rem;
            }
            h1 {
                font-size: 2.5rem;
                letter-spacing: 4px;
            }
            header {
                padding-top: 80px;
            }
        }
    </style>
</head>
<body class="show-en">
    <!-- Language Switcher -->
    <div class="lang-switcher">
        <button class="lang-btn active" id="btn-en" onclick="setLang('en')">EN</button>
        <button class="lang-btn" id="btn-lt" onclick="setLang('lt')">LT</button>
    </div>

    <div class="container">
        <header>
            <h1>SEOvoras</h1>
            <p class="subtitle">
                <span class="lang-en">Article Submission Automation System</span>
                <span class="lang-lt">Straipsnių pateikimo automatizavimo sistema</span>
            </p>
        </header>

        <!-- EXECUTIVE SUMMARY -->
        <section class="executive-summary">
            <h2>
                <span class="lang-en">Executive Summary</span>
                <span class="lang-lt">Santrauka</span>
            </h2>
            <p class="lead">
                <span class="lang-en">Employees fill article info in their Google Sheets, click "Submit" → system sends emails to publishers with attachments → tracks invoices automatically.</span>
                <span class="lang-lt">Darbuotojai užpildo straipsnių informaciją savo Google Sheets, spaudžia "Submit" → sistema siunčia laiškus leidėjams su priedais → automatiškai seka sąskaitas.</span>
            </p>
            <div class="decisions">
                <div class="decision-item lang-en">Each employee manages their own sheet (decentralized)</div>
                <div class="decision-item lang-lt">Kiekvienas darbuotojas tvarko savo lentelę (decentralizuota)</div>
                <div class="decision-item lang-en">All employees share one Gmail account for sending</div>
                <div class="decision-item lang-lt">Visi darbuotojai dalinasi viena Gmail paskyra siuntimui</div>
                <div class="decision-item lang-en">Master Sheet is single source of truth (queue, matching, audit)</div>
                <div class="decision-item lang-lt">Pagrindinė lentelė yra vienintelis tiesos šaltinis (eilė, suderinimas, auditas)</div>
                <div class="decision-item lang-en">Rate limiting configurable (default 20-30 emails/hour)</div>
                <div class="decision-item lang-lt">Siuntimo ribojimas konfigūruojamas (numatytai 20-30 laiškų/val)</div>
                <div class="decision-item lang-en">Invoice matching by portal totals (not individual articles)</div>
                <div class="decision-item lang-lt">Sąskaitų suderinimas pagal portalo sumas (ne atskirus straipsnius)</div>
                <div class="decision-item lang-en">Gemini AI extracts invoice data from PDFs</div>
                <div class="decision-item lang-lt">Gemini AI ištraukia sąskaitų duomenis iš PDF</div>
            </div>
            <div class="cost-total" style="margin-top: 25px;">
                <span class="lang-en">Cost: ~€6-14/month</span>
                <span class="lang-lt">Kaina: ~€6-14/mėn.</span>
            </div>
        </section>

        <div class="section-divider">
            <span class="lang-en">System Details</span>
            <span class="lang-lt">Sistemos detalės</span>
        </div>

        <!-- SYSTEM OVERVIEW SECTION -->
        <section>
            <h2>
                <span class="lang-en">System Overview</span>
                <span class="lang-lt">Sistemos apžvalga</span>
            </h2>

            <div class="ascii-diagram lang-en">Employee Sheets                      Master Sheet                        Gmail
┌─────────────────┐                 ┌────────────────────────┐          ┌──────┐
│ Employee A      │                 │ [Settings] [Portals]   │          │      │
│ (single tab,    │  [Submit to     │ [Processed] [Dec] ...  │          │      │
│  all months)    │   Queue] ────►  │                        │          │      │
├─────────────────┤                 │ • Global Queue         │ ─Send──► │      │
│ Employee B      │  ─────────────► │ • Invoice Matching     │          │      │
├─────────────────┤                 │ • Audit Trail          │          │      │
│ Employee C      │  ─────────────► │ • Employee Registry    │          └──────┘
└─────────────────┘                 └────────────────────────┘               │
        ▲                                    │ ▲                             │
        │   (via Sheet ID + Row ID)          │ │                             │
        └──── Status sync back ──────────────┘ │                             │
                                               │                             │
Google Drive                                   │                             │
┌─────────────────┐                            │                             │
│ SEOvoras Files/ │ (owned by Master owner)    │                             │
│  ├── Jurgita/   │◄───────────────────────────┘                             │
│  ├── Jonas/     │  fetch attachments                                       │
│  └── Ona/       │                                                          │
└─────────────────┘                                                          │
                                                                             │
                        ┌────────────────────────────────────┐               │
                        │         Cloud Run (Python)         │               │
                        │  • Queue processor (every 5-10 min)│◄──────────────┘
                        │  • Invoice processor               │  PDF attachments
                        │  • Gemini 2.5 Flash integration    │
                        └────────────────────────────────────┘</div>
            <div class="ascii-diagram lang-lt">Darbuotojų lentelės                  Pagrindinė lentelė                  Gmail
┌─────────────────┐                 ┌────────────────────────┐          ┌──────┐
│ Darbuotojas A   │                 │ [Settings] [Portals]   │          │      │
│ (vienas lapas,  │  [Pateikti      │ [Processed] [Gru] ...  │          │      │
│  visi mėnesiai) │   eilei] ────►  │                        │          │      │
├─────────────────┤                 │ • Globali eilė         │ ─Siųsti─►│      │
│ Darbuotojas B   │  ─────────────► │ • Sąskaitų suderinimas │          │      │
├─────────────────┤                 │ • Audito pėdsakas      │          │      │
│ Darbuotojas C   │  ─────────────► │ • Darbuotojų registras │          └──────┘
└─────────────────┘                 └────────────────────────┘               │
        ▲                                    │ ▲                             │
        │   (per Sheet ID + Row ID)          │ │                             │
        └──── Būsenos sinchronizacija ───────┘ │                             │
                                               │                             │
Google Drive                                   │                             │
┌─────────────────┐                            │                             │
│ SEOvoras Files/ │ (priklauso savininkui)     │                             │
│  ├── Jurgita/   │◄───────────────────────────┘                             │
│  ├── Jonas/     │  gauti priedus                                           │
│  └── Ona/       │                                                          │
└─────────────────┘                                                          │
                                                                             │
                        ┌────────────────────────────────────┐               │
                        │         Cloud Run (Python)         │               │
                        │  • Eilės procesorius (kas 5-10 min)│◄──────────────┘
                        │  • Sąskaitų procesorius            │  PDF priedai
                        │  • Gemini 2.5 Flash integracija    │
                        └────────────────────────────────────┘</div>

            <p>
                <span class="lang-en"><strong>Master Sheet is the single source of truth</strong> for queue processing, invoice matching, and audit trail.</span>
                <span class="lang-lt"><strong>Pagrindinė lentelė yra vienintelis tiesos šaltinis</strong> eilės apdorojimui, sąskaitų suderinimui ir audito pėdsakui.</span>
            </p>
        </section>

        <!-- WORKFLOW SECTION -->
        <section class="standalone">
            <h2>
                <span class="lang-en">Workflow</span>
                <span class="lang-lt">Darbo eiga</span>
            </h2>

            <!-- Step 1 -->
            <div id="step-1" class="step-section">
            <h3>
                <span class="step-num">1</span>
                <span>
                    <span class="lang-en">Article Preparation</span>
                    <span class="lang-lt">Straipsnio ruošimas</span>
                </span>
            </h3>
            <p>
                <span class="lang-en">Each employee works in their own Google Sheet (single tab, all months):</span>
                <span class="lang-lt">Kiekvienas darbuotojas dirba savo Google Sheet (vienas lapas, visi mėnesiai):</span>
            </p>
            <ul class="lang-en">
                <li>Fill in article info (title, portal, price, currency, month)</li>
                <li>Upload Word + JPG files to their personal Drive folder</li>
                <li>Set status to "Complete" when ready</li>
            </ul>
            <ul class="lang-lt">
                <li>Užpildyti straipsnio informaciją (pavadinimas, portalas, kaina, valiuta, mėnuo)</li>
                <li>Įkelti Word + JPG failus į savo asmeninį Drive aplanką</li>
                <li>Nustatyti būseną "Complete" kai paruošta</li>
            </ul>
            </div>

            <!-- Step 2 -->
            <div id="step-2" class="step-section">
            <h3>
                <span class="step-num">2</span>
                <span>
                    <span class="lang-en">File Matching</span>
                    <span class="lang-lt">Failų atitikimas</span>
                </span>
            </h3>
            <p>
                <span class="lang-en">Files matched by <strong>fuzzy title matching</strong> (≥95% similarity):</span>
                <span class="lang-lt">Failai suderinami pagal <strong>apytikslį pavadinimo atitikimą</strong> (≥95% panašumas):</span>
            </p>
            <div class="flow-diagram">
                Title: "Kiek kainuoja saulės elektrinė?"<br>
                <span class="arrow">  ↓</span> normalize (lowercase, remove punctuation)<br>
                "kiek kainuoja saules elektrine"<br>
                <span class="arrow">  ↓</span> compare to normalized filenames<br>
                File: "30. Kiek kainuoja saulės elektrinė.docx"<br>
                <span class="arrow">  ↓</span> similarity ≥ 95%<br>
                <span class="check">✓ Match</span>
            </div>
            <p>
                <span class="lang-en">Both <code>.docx</code> and image (<code>.jpg</code>, <code>.png</code>) must match. If no match → <span class="warning">error, don't send</span>.</span>
                <span class="lang-lt">Abu <code>.docx</code> ir paveikslėlis (<code>.jpg</code>, <code>.png</code>) turi atitikti. Jei nėra atitikimo → <span class="warning">klaida, nesiųsti</span>.</span>
            </p>
            </div>

            <!-- Step 3 -->
            <div id="step-3" class="step-section">
            <h3>
                <span class="step-num">3</span>
                <span>
                    <span class="lang-en">Queue Submission</span>
                    <span class="lang-lt">Pateikimas eilei</span>
                </span>
            </h3>
            <p>
                <span class="lang-en">Employee clicks <strong>"Submit to Queue"</strong> button:</span>
                <span class="lang-lt">Darbuotojas spaudžia <strong>"Submit to Queue"</strong> mygtuką:</span>
            </p>
            <ul class="lang-en">
                <li>Script validates row data (required fields)</li>
                <li>Fuzzy-matches files in Drive folder</li>
                <li>Copies row to Master Sheet with status "Queued"</li>
                <li>Records Source Sheet ID + Source Row ID for sync</li>
                <li>Records matched file names with Drive links (for verification)</li>
            </ul>
            <ul class="lang-lt">
                <li>Skriptas tikrina eilutės duomenis (privalomus laukus)</li>
                <li>Apytiksliai suderina failus Drive aplanke</li>
                <li>Kopijuoja eilutę į pagrindinę lentelę su būsena "Queued"</li>
                <li>Įrašo Source Sheet ID + Source Row ID sinchronizacijai</li>
                <li>Įrašo suderintų failų pavadinimus su Drive nuorodomis (patikrinimui)</li>
            </ul>
            <p>
                <span class="lang-en">This is a <strong>push-based</strong> trigger - explicit employee action, no ambiguity about readiness.</span>
                <span class="lang-lt">Tai <strong>push</strong> tipo paleidimas - aiškus darbuotojo veiksmas, nėra abejonių dėl paruoštumo.</span>
            </p>
            </div>

            <!-- Step 4 -->
            <div id="step-4" class="step-section">
            <h3>
                <span class="step-num">4</span>
                <span>
                    <span class="lang-en">Email Sending</span>
                    <span class="lang-lt">Laiškų siuntimas</span>
                </span>
            </h3>
            <p>
                <span class="lang-en">Scheduled job processes Master Sheet queue (Cloud Scheduler, every 5-10 min):</span>
                <span class="lang-lt">Suplanuota užduotis apdoroja pagrindinės lentelės eilę (Cloud Scheduler, kas 5-10 min):</span>
            </p>
            <div class="flow-diagram lang-en">
                Find all "Queued" rows (FIFO order)<br>
                <span class="arrow">  ↓</span><br>
                Retrieve files from employee's Drive folder<br>
                <span class="arrow">  ↓</span><br>
                Compose email using template (LT or EN)<br>
                <span class="arrow">  ↓</span><br>
                Send via shared Gmail with attachments<br>
                <span class="arrow">  ↓</span><br>
                Update Master Sheet: status "Sent", timestamp, email link<br>
                <span class="arrow">  ↓</span><br>
                Sync status back to employee sheet
            </div>
            <div class="flow-diagram lang-lt">
                Rasti visas "Queued" eilutes (FIFO tvarka)<br>
                <span class="arrow">  ↓</span><br>
                Gauti failus iš darbuotojo Drive aplanko<br>
                <span class="arrow">  ↓</span><br>
                Sudaryti laišką naudojant šabloną (LT arba EN)<br>
                <span class="arrow">  ↓</span><br>
                Siųsti per bendrą Gmail su priedais<br>
                <span class="arrow">  ↓</span><br>
                Atnaujinti pagrindinę lentelę: būsena "Sent", laikas, laiško nuoroda<br>
                <span class="arrow">  ↓</span><br>
                Sinchronizuoti būseną atgal į darbuotojo lentelę
            </div>

            <p>
                <span class="lang-en"><strong>Rate Limiting</strong> (configurable in Settings tab):</span>
                <span class="lang-lt"><strong>Siuntimo ribojimas</strong> (konfigūruojama Settings skirtuke):</span>
            </p>
            <ul class="lang-en">
                <li>Default: 20-30 emails per hour</li>
                <li>Random pause between each (30-90 sec)</li>
                <li>First month: start slower (10-15/hour)</li>
            </ul>
            <ul class="lang-lt">
                <li>Numatytai: 20-30 laiškų per valandą</li>
                <li>Atsitiktinė pauzė tarp kiekvieno (30-90 sek)</li>
                <li>Pirmas mėnuo: pradėti lėčiau (10-15/val)</li>
            </ul>

            <div class="progress-example">
                <span>Queued: <strong>45</strong></span>
                <span>Sent: <strong class="check">12</strong></span>
                <span>Remaining: <strong class="warning">33</strong></span>
            </div>
            </div>

            <!-- Step 5 -->
            <div id="step-5" class="step-section">
            <h3>
                <span class="step-num">5</span>
                <span>
                    <span class="lang-en">Invoice Email Detection</span>
                    <span class="lang-lt">Sąskaitų laiškų aptikimas</span>
                </span>
            </h3>
            <p>
                <span class="lang-en">Scheduled job scans Gmail for invoice candidates:</span>
                <span class="lang-lt">Suplanuota užduotis skanuoja Gmail ieškodama sąskaitų:</span>
            </p>
            <div class="flow-diagram lang-en">
                Gmail query: "has:attachment filename:pdf -label:SEOvoras-Processed"<br>
                <span class="arrow">  ↓</span><br>
                For each email: check if already in "Processed Emails" tab<br>
                <span class="arrow">  ↓</span><br>
                Download PDF attachment(s)<br>
                <span class="arrow">  ↓</span><br>
                Send to Gemini for classification + extraction<br>
                <span class="arrow">  ↓</span><br>
                Add Gmail label "SEOvoras-Processed"<br>
                <span class="arrow">  ↓</span><br>
                Log to "Processed Emails" tab
            </div>
            <div class="flow-diagram lang-lt">
                Gmail užklausa: "has:attachment filename:pdf -label:SEOvoras-Processed"<br>
                <span class="arrow">  ↓</span><br>
                Kiekvienam laiškui: patikrinti ar jau yra "Processed Emails" skirtuke<br>
                <span class="arrow">  ↓</span><br>
                Atsisiųsti PDF priedą(-us)<br>
                <span class="arrow">  ↓</span><br>
                Siųsti Gemini klasifikuoti ir išgauti duomenis<br>
                <span class="arrow">  ↓</span><br>
                Pridėti Gmail etiketę "SEOvoras-Processed"<br>
                <span class="arrow">  ↓</span><br>
                Įrašyti į "Processed Emails" skirtuką
            </div>
            </div>

            <!-- Step 6 -->
            <div id="step-6" class="step-section">
            <h3>
                <span class="step-num">6</span>
                <span>
                    <span class="lang-en">Invoice Processing</span>
                    <span class="lang-lt">Sąskaitų apdorojimas</span>
                </span>
            </h3>
            <p>
                <span class="lang-en"><strong>Gemini 2.5 Flash</strong> - single call to classify and extract:</span>
                <span class="lang-lt"><strong>Gemini 2.5 Flash</strong> - vienas iškvietimas klasifikuoti ir ištraukti:</span>
            </p>
            <ul class="lang-en">
                <li>PDF-native processing (~$0.0007/invoice)</li>
                <li>Returns structured JSON with supplier, line items, totals</li>
                <li>Extracts portal name, quantity, discount %, amounts</li>
                <li>If not an invoice → returns <code>{is_invoice: false}</code></li>
            </ul>
            <ul class="lang-lt">
                <li>Tiesioginis PDF apdorojimas (~$0.0007/sąskaita)</li>
                <li>Grąžina struktūrizuotą JSON su tiekėju, eilutėmis, sumomis</li>
                <li>Ištraukia portalo pavadinimą, kiekį, nuolaidą %, sumas</li>
                <li>Jei ne sąskaita → grąžina <code>{is_invoice: false}</code></li>
            </ul>
            </div>

            <!-- Step 7 -->
            <div id="step-7" class="step-section">
            <h3>
                <span class="step-num">7</span>
                <span>
                    <span class="lang-en">Invoice Matching</span>
                    <span class="lang-lt">Sąskaitų suderinimas</span>
                </span>
            </h3>
            <p>
                <span class="lang-en">Invoices matched at <strong>portal level</strong> (not individual articles):</span>
                <span class="lang-lt">Sąskaitos suderinamos <strong>portalo lygmeniu</strong> (ne atskirų straipsnių):</span>
            </p>
            <div class="flow-diagram">
                Invoice line: Ulac.lt, 7 vnt, €250.25<br>
                <span class="arrow">  ↓</span><br>
                Search Master Sheet: Portal = "Ulac.lt" AND Status = "Sent"<br>
                <span class="arrow">  ↓</span><br>
                Found 7 rows from 3 employees:<br>
                &nbsp;&nbsp;Jurgita: 4 × €35.75 = €143.00<br>
                &nbsp;&nbsp;Jonas:   2 × €35.75 = €71.50<br>
                &nbsp;&nbsp;Ona:     1 × €35.75 = €35.75<br>
                &nbsp;&nbsp;Total: €250.25 <span class="check">✓</span><br>
                <span class="arrow">  ↓</span><br>
                Mark all 7 rows: Status = "Invoice Received"<br>
                <span class="arrow">  ↓</span><br>
                Sync status back to each employee's sheet
            </div>
            <p>
                <span class="lang-en">If count or amount mismatch → <span class="warning">"Manual Review Required"</span></span>
                <span class="lang-lt">Jei kiekis arba suma nesutampa → <span class="warning">"Manual Review Required"</span></span>
            </p>
            </div>
        </section>

        <div class="section-divider"></div>

        <!-- DATA STRUCTURE SECTION -->
        <section class="standalone">
            <h2>
                <span class="lang-en">Data Structure</span>
                <span class="lang-lt">Duomenų struktūra</span>
            </h2>

            <h3>
                <span class="lang-en">Master Sheet Tabs</span>
                <span class="lang-lt">Pagrindinės lentelės skirtukai</span>
            </h3>
            <ul class="lang-en">
                <li><strong>Settings</strong> - Employee registry, rate limiting, system config</li>
                <li><strong>Portals</strong> - Portal contact lookup (email for sending, invoice email)</li>
                <li><strong>Monthly tabs</strong> - December, January, etc. (the queue)</li>
                <li><strong>Processed Emails</strong> - Tracks processed email IDs (backup to Gmail labels)</li>
            </ul>
            <ul class="lang-lt">
                <li><strong>Settings</strong> - Darbuotojų registras, siuntimo ribojimas, sistemos konfigūracija</li>
                <li><strong>Portals</strong> - Portalų kontaktų paieška (siuntimo el. paštas, sąskaitų el. paštas)</li>
                <li><strong>Mėnesiniai skirtukai</strong> - Gruodis, Sausis ir t.t. (eilė)</li>
                <li><strong>Processed Emails</strong> - Seka apdorotų laiškų ID (atsarginė kopija Gmail etiketėms)</li>
            </ul>

            <h3>
                <span class="lang-en">Settings Tab - Employee Registry</span>
                <span class="lang-lt">Settings skirtukas - Darbuotojų registras</span>
            </h3>
            <table>
                <thead>
                    <tr>
                        <th>
                            <span class="lang-en">Column</span>
                            <span class="lang-lt">Stulpelis</span>
                        </th>
                        <th>
                            <span class="lang-en">Description</span>
                            <span class="lang-lt">Aprašymas</span>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Employee Name</td>
                        <td>
                            <span class="lang-en">Display name</span>
                            <span class="lang-lt">Rodomas vardas</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Email</td>
                        <td>
                            <span class="lang-en">Employee email (for sharing)</span>
                            <span class="lang-lt">Darbuotojo el. paštas (bendrinimui)</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Sheet ID</td>
                        <td>
                            <span class="lang-en">(auto) - filled by onboarding script</span>
                            <span class="lang-lt">(auto) - užpildo prijungimo skriptas</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Folder ID</td>
                        <td>
                            <span class="lang-en">(auto) - filled by onboarding script</span>
                            <span class="lang-lt">(auto) - užpildo prijungimo skriptas</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Active</td>
                        <td>
                            <span class="lang-en">Checkbox - uncheck to deactivate</span>
                            <span class="lang-lt">Žymimasis langelis - nuimti, norint deaktyvuoti</span>
                        </td>
                    </tr>
                </tbody>
            </table>

            <h3>
                <span class="lang-en">Automated Employee Onboarding</span>
                <span class="lang-lt">Automatizuotas darbuotojų prijungimas</span>
            </h3>
            <p>
                <span class="lang-en">Owner clicks <strong>"Setup New Employees"</strong> button. Script finds rows where Active = ✓ but Sheet ID is empty:</span>
                <span class="lang-lt">Savininkas spaudžia <strong>"Setup New Employees"</strong> mygtuką. Skriptas randa eilutes kur Active = ✓ bet Sheet ID tuščias:</span>
            </p>
            <div class="flow-diagram lang-en">
                For each new employee:<br>
                <span class="arrow">  1.</span> Create subfolder: "SEOvoras Files/{Name}/"<br>
                <span class="arrow">  2.</span> Create Employee Sheet from template<br>
                <span class="arrow">  3.</span> Share folder with employee (Editor)<br>
                <span class="arrow">  4.</span> Share sheet with employee (Editor)<br>
                <span class="arrow">  5.</span> Fill in Sheet ID and Folder ID<br>
                <span class="arrow">  6.</span> Show confirmation toast
            </div>
            <div class="flow-diagram lang-lt">
                Kiekvienam naujam darbuotojui:<br>
                <span class="arrow">  1.</span> Sukurti poaplankį: "SEOvoras Files/{Vardas}/"<br>
                <span class="arrow">  2.</span> Sukurti darbuotojo lentelę iš šablono<br>
                <span class="arrow">  3.</span> Bendrinti aplanką su darbuotoju (Redaktorius)<br>
                <span class="arrow">  4.</span> Bendrinti lentelę su darbuotoju (Redaktorius)<br>
                <span class="arrow">  5.</span> Užpildyti Sheet ID ir Folder ID<br>
                <span class="arrow">  6.</span> Parodyti patvirtinimo pranešimą
            </div>
            <p>
                <span class="lang-en"><strong>All assets owned by Master Sheet owner</strong> - consistent permissions, centralized control.</span>
                <span class="lang-lt"><strong>Visi ištekliai priklauso pagrindinės lentelės savininkui</strong> - nuoseklūs leidimai, centralizuota kontrolė.</span>
            </p>

            <h3>
                <span class="lang-en">Employee Sheet</span>
                <span class="lang-lt">Darbuotojo lentelė</span>
            </h3>
            <table>
                <thead>
                    <tr>
                        <th>
                            <span class="lang-en">Column</span>
                            <span class="lang-lt">Stulpelis</span>
                        </th>
                        <th>
                            <span class="lang-en">Editable</span>
                            <span class="lang-lt">Redaguojama</span>
                        </th>
                        <th>
                            <span class="lang-en">Description</span>
                            <span class="lang-lt">Aprašymas</span>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Row ID</td>
                        <td>
                            <span class="lang-en">locked</span>
                            <span class="lang-lt">užrakinta</span>
                        </td>
                        <td>
                            <span class="lang-en">Auto-generated unique ID for sync</span>
                            <span class="lang-lt">Automatiškai sugeneruotas unikalus ID sinchronizacijai</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Month</td>
                        <td>
                            <span class="lang-en">yes</span>
                            <span class="lang-lt">taip</span>
                        </td>
                        <td>
                            <span class="lang-en">Target month (dropdown)</span>
                            <span class="lang-lt">Tikslinis mėnuo (išskleidžiamas)</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Title</td>
                        <td>
                            <span class="lang-en">yes</span>
                            <span class="lang-lt">taip</span>
                        </td>
                        <td>
                            <span class="lang-en">Article title (fuzzy-matched to files)</span>
                            <span class="lang-lt">Straipsnio pavadinimas (apytiksliai suderinamas su failais)</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Portal</td>
                        <td>
                            <span class="lang-en">yes</span>
                            <span class="lang-lt">taip</span>
                        </td>
                        <td>
                            <span class="lang-en">Publisher name (dropdown)</span>
                            <span class="lang-lt">Leidėjo pavadinimas (išskleidžiamas)</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Price</td>
                        <td>
                            <span class="lang-en">yes</span>
                            <span class="lang-lt">taip</span>
                        </td>
                        <td>
                            <span class="lang-en">Article price (before discount)</span>
                            <span class="lang-lt">Straipsnio kaina (prieš nuolaidą)</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Currency</td>
                        <td>
                            <span class="lang-en">yes</span>
                            <span class="lang-lt">taip</span>
                        </td>
                        <td>
                            <span class="lang-en">EUR, USD, PLN (dropdown)</span>
                            <span class="lang-lt">EUR, USD, PLN (išskleidžiamas)</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Matched DOCX</td>
                        <td>
                            <span class="lang-en">locked</span>
                            <span class="lang-lt">užrakinta</span>
                        </td>
                        <td>
                            <span class="lang-en">Drive link to matched Word file</span>
                            <span class="lang-lt">Drive nuoroda į Word failą</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Matched Image</td>
                        <td>
                            <span class="lang-en">locked</span>
                            <span class="lang-lt">užrakinta</span>
                        </td>
                        <td>
                            <span class="lang-en">Drive link to matched image file</span>
                            <span class="lang-lt">Drive nuoroda į paveikslėlio failą</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Status</td>
                        <td>
                            <span class="lang-en">locked</span>
                            <span class="lang-lt">užrakinta</span>
                        </td>
                        <td>Draft → Complete → Queued → Sent → Invoice</td>
                    </tr>
                    <tr>
                        <td>Sent At</td>
                        <td>
                            <span class="lang-en">locked</span>
                            <span class="lang-lt">užrakinta</span>
                        </td>
                        <td>
                            <span class="lang-en">Auto-filled after sending</span>
                            <span class="lang-lt">Automatiškai užpildoma po siuntimo</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Email Link</td>
                        <td>
                            <span class="lang-en">locked</span>
                            <span class="lang-lt">užrakinta</span>
                        </td>
                        <td>
                            <span class="lang-en">Direct Gmail link, auto-filled</span>
                            <span class="lang-lt">Tiesioginė Gmail nuoroda, automatiškai užpildoma</span>
                        </td>
                    </tr>
                    <tr>
                        <td>Invoice #</td>
                        <td>
                            <span class="lang-en">locked</span>
                            <span class="lang-lt">užrakinta</span>
                        </td>
                        <td>
                            <span class="lang-en">Auto-filled after matching</span>
                            <span class="lang-lt">Automatiškai užpildoma po suderinimo</span>
                        </td>
                    </tr>
                </tbody>
            </table>

            <h3>
                <span class="lang-en">Portals Tab</span>
                <span class="lang-lt">Portals skirtukas</span>
            </h3>
            <table>
                <thead>
                    <tr>
                        <th>Portal</th>
                        <th>
                            <span class="lang-en">Email for Sending</span>
                            <span class="lang-lt">El. paštas siuntimui</span>
                        </th>
                        <th>
                            <span class="lang-en">Invoice Email</span>
                            <span class="lang-lt">Sąskaitų el. paštas</span>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Ulac.lt</td>
                        <td>editor@ulac.lt</td>
                        <td>accounting@ulac.lt</td>
                    </tr>
                    <tr>
                        <td>Foodout.lt</td>
                        <td>info@foodout.lt</td>
                        <td>info@foodout.lt</td>
                    </tr>
                    <tr>
                        <td>Nezinau.lt</td>
                        <td>redakcija@nezinau.lt</td>
                        <td>buhalterija@nezinau.lt</td>
                    </tr>
                </tbody>
            </table>
            <p>
                <span class="lang-en">Discount % is extracted from each invoice by Gemini (varies by order volume, agreements).</span>
                <span class="lang-lt">Nuolaidos % ištraukiama iš kiekvienos sąskaitos Gemini (priklauso nuo užsakymo apimties, susitarimų).</span>
            </p>
        </section>

        <!-- TECH STACK SECTION -->
        <section class="standalone">
            <h2>
                <span class="lang-en">Tech Stack</span>
                <span class="lang-lt">Technologijos</span>
            </h2>

            <div class="tech-grid">
                <div class="tech-item">
                    <div class="icon">🐍</div>
                    <div>Python</div>
                    <small>Backend</small>
                </div>
                <div class="tech-item">
                    <div class="icon">📜</div>
                    <div>Apps Script</div>
                    <small>
                        <span class="lang-en">Sheet buttons, validation</span>
                        <span class="lang-lt">Lentelės mygtukai, validacija</span>
                    </small>
                </div>
                <div class="tech-item">
                    <div class="icon">☁️</div>
                    <div>Cloud Run</div>
                    <small>
                        <span class="lang-en">Serverless hosting</span>
                        <span class="lang-lt">Serverless talpinimas</span>
                    </small>
                </div>
                <div class="tech-item">
                    <div class="icon">⏰</div>
                    <div>Cloud Scheduler</div>
                    <small>
                        <span class="lang-en">Queue triggers</span>
                        <span class="lang-lt">Eilės paleidikliai</span>
                    </small>
                </div>
                <div class="tech-item">
                    <div class="icon">📊</div>
                    <div>Google Workspace</div>
                    <small>Gmail, Sheets, Drive</small>
                </div>
                <div class="tech-item">
                    <div class="icon">🤖</div>
                    <div>Gemini 2.5 Flash</div>
                    <small>
                        <span class="lang-en">Invoice processing</span>
                        <span class="lang-lt">Sąskaitų apdorojimas</span>
                    </small>
                </div>
                <div class="tech-item">
                    <div class="icon">🔐</div>
                    <div>OAuth</div>
                    <small>
                        <span class="lang-en">Authentication</span>
                        <span class="lang-lt">Autentifikacija</span>
                    </small>
                </div>
            </div>

            <h3>
                <span class="lang-en">Monthly Cost</span>
                <span class="lang-lt">Mėnesinė kaina</span>
            </h3>
            <table>
                <thead>
                    <tr>
                        <th>
                            <span class="lang-en">Component</span>
                            <span class="lang-lt">Komponentas</span>
                        </th>
                        <th>
                            <span class="lang-en">Cost</span>
                            <span class="lang-lt">Kaina</span>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Google Workspace (1 user)</td>
                        <td>€6-12</td>
                    </tr>
                    <tr>
                        <td>Google Cloud (Run + Scheduler)</td>
                        <td>€0-2</td>
                    </tr>
                    <tr>
                        <td>Gemini API (~100 invoices)</td>
                        <td>~€0.07</td>
                    </tr>
                </tbody>
            </table>

            <div class="cost-total">
                <span class="lang-en">Total: ~€6-14/month</span>
                <span class="lang-lt">Viso: ~€6-14/mėn.</span>
            </div>
        </section>

        <!-- STATUS SECTION -->
        <section>
            <h2>
                <span class="lang-en">Status</span>
                <span class="lang-lt">Būsena</span>
            </h2>
            <p style="text-align: center; padding: 20px;">
                <span class="status-badge status-ready">
                    <span class="lang-en">Sample data received</span>
                    <span class="lang-lt">Pavyzdiniai duomenys gauti</span>
                </span>
            </p>
            <p style="text-align: center;">
                <span class="lang-en">Ready to build prototype</span>
                <span class="lang-lt">Paruošta kurti prototipą</span>
            </p>
        </section>

        <footer>
            <p>SEOvoras &copy; 2025</p>
        </footer>
    </div>

    <script>
        function setLang(lang) {
            document.body.classList.remove('show-en', 'show-lt');
            document.body.classList.add('show-' + lang);

            document.getElementById('btn-en').classList.remove('active');
            document.getElementById('btn-lt').classList.remove('active');
            document.getElementById('btn-' + lang).classList.add('active');

            // Save preference
            localStorage.setItem('seovoras-lang', lang);

            // Update page title
            if (lang === 'lt') {
                document.title = 'SEOvoras - Straipsnių pateikimo automatizavimas';
            } else {
                document.title = 'SEOvoras - Article Submission Automation';
            }
        }

        // Load saved preference or detect browser language
        document.addEventListener('DOMContentLoaded', function() {
            var savedLang = localStorage.getItem('seovoras-lang');
            if (savedLang) {
                setLang(savedLang);
            } else {
                // Detect browser language
                var browserLang = navigator.language || navigator.userLanguage;
                if (browserLang.startsWith('lt')) {
                    setLang('lt');
                }
            }
        });
    </script>
</body>
</html>
